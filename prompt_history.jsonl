{
  "timestamp": "2025-08-10T15:58:20.763582",
  "prompt": "### System Instruction\nYou are a Python coding assistant. Your task is to generate executable Python code only.\n    Do not include markdown, explanations, comments, or formatting.\n\n    Your code must:\n    - Encapsulate logic in a function (e.g., scrape_and_analyze())\n    - Always include a top-level execution block using:\n        if __name__ == \"__main__\":\n            result = <function_name>()\n            print(result)\n\n    Important:\n    - Do NOT suppress errors using try-except blocks.\n    - If an error occurs (e.g., missing table, invalid data), raise a Python exception with a clear message.\n    - Do NOT return fallback values like \"N/A\" or \"Error: Table not found\".\n    - Let errors propagate so they can be detected and corrected in future iterations.\n\n    If plotting is involved:\n    - Invert ranks on the x-axis for better readability.\n    - Return the plot as a base64-encoded data URI.\n\n    Only return valid Python code that can be run directly in a script.\n\n### Task\nThe Indian high court judgement dataset contains judgements from the Indian High Courts, downloaded from [ecourts website](https://judgments.ecourts.gov.in/). It contains judgments of 25 high courts, along with raw metadata (as .json) and structured metadata (as .parquet).\r\n\r\n- 25 high courts\r\n- ~16M judgments\r\n- ~1TB of data\r\n\r\nStructure of the data in the bucket:\r\n\r\n- `data/pdf/year=2025/court=xyz/bench=xyz/judgment1.pdf,judgment2.pdf`\r\n- `metadata/json/year=2025/court=xyz/bench=xyz/judgment1.json,judgment2.json`\r\n- `metadata/parquet/year=2025/court=xyz/bench=xyz/metadata.parquet`\r\n- `metadata/tar/year=2025/court=xyz/bench=xyz/metadata.tar.gz`\r\n- `data/tar/year=2025/court=xyz/bench=xyz/pdfs.tar`\r\n\r\nThis DuckDB query counts the number of decisions in the dataset.\r\n\r\n```sql\r\nINSTALL httpfs; LOAD httpfs;\r\nINSTALL parquet; LOAD parquet;\r\n\r\nSELECT COUNT(*) FROM read_parquet('s3://indian-high-court-judgments/metadata/parquet/year=*/court=*/bench=*/metadata.parquet?s3_region=ap-south-1');\r\n```\r\n\r\nHere are the columns in the data:\r\n\r\n| Column                 | Type    | Description                    |\r\n| ---------------------- | ------- | ------------------------------ |\r\n| `court_code`           | VARCHAR | Court identifier (e.g., 33~10) |\r\n| `title`                | VARCHAR | Case title and parties         |\r\n| `description`          | VARCHAR | Case description               |\r\n| `judge`                | VARCHAR | Presiding judge(s)             |\r\n| `pdf_link`             | VARCHAR | Link to judgment PDF           |\r\n| `cnr`                  | VARCHAR | Case Number Register           |\r\n| `date_of_registration` | VARCHAR | Registration date              |\r\n| `decision_date`        | DATE    | Date of judgment               |\r\n| `disposal_nature`      | VARCHAR | Case outcome                   |\r\n| `court`                | VARCHAR | Court name                     |\r\n| `raw_html`             | VARCHAR | Original HTML content          |\r\n| `bench`                | VARCHAR | Bench identifier               |\r\n| `year`                 | BIGINT  | Year partition                 |\r\n\r\nHere is a sample row:\r\n\r\n```json\r\n{\r\n  \"court_code\": \"33~10\",\r\n  \"title\": \"CRL MP(MD)/4399/2023 of Vinoth Vs The Inspector of Police\",\r\n  \"description\": \"No.4399 of 2023 BEFORE THE MADURAI BENCH OF MADRAS HIGH COURT ( Criminal Jurisdiction ) Thursday, ...\",\r\n  \"judge\": \"HONOURABLE  MR JUSTICE G.K. ILANTHIRAIYAN\",\r\n  \"pdf_link\": \"court/cnrorders/mdubench/orders/HCMD010287762023_1_2023-03-16.pdf\",\r\n  \"cnr\": \"HCMD010287762023\",\r\n  \"date_of_registration\": \"14-03-2023\",\r\n  \"decision_date\": \"2023-03-16\",\r\n  \"disposal_nature\": \"DISMISSED\",\r\n  \"court\": \"33_10\",\r\n  \"raw_html\": \"<button type='button' role='link'..\",\r\n  \"bench\": \"mdubench\",\r\n  \"year\": 2023\r\n}\r\n```\r\n\r\nAnswer the following questions and respond with a JSON object containing the answer.\r\n\r\n```json\r\n{\r\n  \"Which high court disposed the most cases from 2019 - 2022?\": \"...\",\r\n  \"What's the regression slope of the date_of_registration - decision_date by year in the court=33_10?\": \"...\",\r\n  \"Plot the year and # of days of delay from the above question as a scatterplot with a regression line. Encode as a base64 data URI under 100,000 characters\": \"data:image/webp:base64,...\"\r\n}\r\n```",
  "sections": {
    "Task": "The Indian high court judgement dataset contains judgements from the Indian High Courts, downloaded from [ecourts website](https://judgments.ecourts.gov.in/). It contains judgments of 25 high courts, along with raw metadata (as .json) and structured metadata (as .parquet).\r\n\r\n- 25 high courts\r\n- ~16M judgments\r\n- ~1TB of data\r\n\r\nStructure of the data in the bucket:\r\n\r\n- `data/pdf/year=2025/court=xyz/bench=xyz/judgment1.pdf,judgment2.pdf`\r\n- `metadata/json/year=2025/court=xyz/bench=xyz/judgment1.json,judgment2.json`\r\n- `metadata/parquet/year=2025/court=xyz/bench=xyz/metadata.parquet`\r\n- `metadata/tar/year=2025/court=xyz/bench=xyz/metadata.tar.gz`\r\n- `data/tar/year=2025/court=xyz/bench=xyz/pdfs.tar`\r\n\r\nThis DuckDB query counts the number of decisions in the dataset.\r\n\r\n```sql\r\nINSTALL httpfs; LOAD httpfs;\r\nINSTALL parquet; LOAD parquet;\r\n\r\nSELECT COUNT(*) FROM read_parquet('s3://indian-high-court-judgments/metadata/parquet/year=*/court=*/bench=*/metadata.parquet?s3_region=ap-south-1');\r\n```\r\n\r\nHere are the columns in the data:\r\n\r\n| Column                 | Type    | Description                    |\r\n| ---------------------- | ------- | ------------------------------ |\r\n| `court_code`           | VARCHAR | Court identifier (e.g., 33~10) |\r\n| `title`                | VARCHAR | Case title and parties         |\r\n| `description`          | VARCHAR | Case description               |\r\n| `judge`                | VARCHAR | Presiding judge(s)             |\r\n| `pdf_link`             | VARCHAR | Link to judgment PDF           |\r\n| `cnr`                  | VARCHAR | Case Number Register           |\r\n| `date_of_registration` | VARCHAR | Registration date              |\r\n| `decision_date`        | DATE    | Date of judgment               |\r\n| `disposal_nature`      | VARCHAR | Case outcome                   |\r\n| `court`                | VARCHAR | Court name                     |\r\n| `raw_html`             | VARCHAR | Original HTML content          |\r\n| `bench`                | VARCHAR | Bench identifier               |\r\n| `year`                 | BIGINT  | Year partition                 |\r\n\r\nHere is a sample row:\r\n\r\n```json\r\n{\r\n  \"court_code\": \"33~10\",\r\n  \"title\": \"CRL MP(MD)/4399/2023 of Vinoth Vs The Inspector of Police\",\r\n  \"description\": \"No.4399 of 2023 BEFORE THE MADURAI BENCH OF MADRAS HIGH COURT ( Criminal Jurisdiction ) Thursday, ...\",\r\n  \"judge\": \"HONOURABLE  MR JUSTICE G.K. ILANTHIRAIYAN\",\r\n  \"pdf_link\": \"court/cnrorders/mdubench/orders/HCMD010287762023_1_2023-03-16.pdf\",\r\n  \"cnr\": \"HCMD010287762023\",\r\n  \"date_of_registration\": \"14-03-2023\",\r\n  \"decision_date\": \"2023-03-16\",\r\n  \"disposal_nature\": \"DISMISSED\",\r\n  \"court\": \"33_10\",\r\n  \"raw_html\": \"<button type='button' role='link'..\",\r\n  \"bench\": \"mdubench\",\r\n  \"year\": 2023\r\n}\r\n```\r\n\r\nAnswer the following questions and respond with a JSON object containing the answer.\r\n\r\n```json\r\n{\r\n  \"Which high court disposed the most cases from 2019 - 2022?\": \"...\",\r\n  \"What's the regression slope of the date_of_registration - decision_date by year in the court=33_10?\": \"...\",\r\n  \"Plot the year and # of days of delay from the above question as a scatterplot with a regression line. Encode as a base64 data URI under 100,000 characters\": \"data:image/webp:base64,...\"\r\n}\r\n```"
  }
}
{
  "timestamp": "2025-08-10T16:09:02.029057",
  "prompt": "### System Instruction\nYou are a Python coding assistant. Your task is to generate executable Python code only.\n    Do not include markdown, explanations, comments, or formatting.\n\n    Your code must:\n    - Encapsulate logic in a function (e.g., scrape_and_analyze())\n    - Always include a top-level execution block using:\n        if __name__ == \"__main__\":\n            result = <function_name>()\n            print(result)\n\n    Important:\n    - Do NOT suppress errors using try-except blocks.\n    - If an error occurs (e.g., missing table, invalid data), raise a Python exception with a clear message.\n    - Do NOT return fallback values like \"N/A\" or \"Error: Table not found\".\n    - Let errors propagate so they can be detected and corrected in future iterations.\n\n    If plotting is involved:\n    - Invert ranks on the x-axis for better readability.\n    - Return the plot as a base64-encoded data URI.\n\n    Only return valid Python code that can be run directly in a script.\n\n### Task\nWrite a Python script that reads a CSV file named 'data.csv', calculates the average of a column named 'sales', and prints the result.",
  "sections": {
    "Task": "Write a Python script that reads a CSV file named 'data.csv', calculates the average of a column named 'sales', and prints the result."
  }
}
{
  "timestamp": "2025-08-10T16:22:23.592983",
  "prompt": "### System Instruction\nYou are a Python coding assistant. Your task is to generate executable Python code only.\n    Do not include markdown, explanations, comments, or formatting.\n\n    Your code must:\n    - Encapsulate logic in a function (e.g., scrape_and_analyze())\n    - Always include a top-level execution block using:\n        if __name__ == \"__main__\":\n            result = <function_name>()\n            print(result)\n\n    Important:\n    - Do NOT suppress errors using try-except blocks.\n    - If an error occurs (e.g., missing table, invalid data), raise a Python exception with a clear message.\n    - Do NOT return fallback values like \"N/A\" or \"Error: Table not found\".\n    - Let errors propagate so they can be detected and corrected in future iterations.\n\n    If plotting is involved:\n    - Invert ranks on the x-axis for better readability.\n    - Return the plot as a base64-encoded data URI.\n\n    Only return valid Python code that can be run directly in a script.\n\n### Task\nWrite a Python script that reads a CSV file named 'data.csv', calculates the average of a column named 'sales', and prints the result.",
  "sections": {
    "Task": "Write a Python script that reads a CSV file named 'data.csv', calculates the average of a column named 'sales', and prints the result."
  }
}
{
  "timestamp": "2025-08-10T16:23:59.226843",
  "prompt": "### System Instruction\nYou are a Python coding assistant. Your task is to generate executable Python code only.\n    Do not include markdown, explanations, comments, or formatting.\n\n    Your code must:\n    - Encapsulate logic in a function (e.g., scrape_and_analyze())\n    - Always include a top-level execution block using:\n        if __name__ == \"__main__\":\n            result = <function_name>()\n            print(result)\n\n    Important:\n    - Do NOT suppress errors using try-except blocks.\n    - If an error occurs (e.g., missing table, invalid data), raise a Python exception with a clear message.\n    - Do NOT return fallback values like \"N/A\" or \"Error: Table not found\".\n    - Let errors propagate so they can be detected and corrected in future iterations.\n\n    If plotting is involved:\n    - Invert ranks on the x-axis for better readability.\n    - Return the plot as a base64-encoded data URI.\n\n    Only return valid Python code that can be run directly in a script.\n\n### Task\nDalculate the Pearson correlation coefficient between Vaccination_Rate and Mortality_Rate in the dataset provided in xlsx file named 'q-correlate-pair.xlsx'.\r\nWhat is the Pearson correlation coefficient between Vaccination_Rate and Mortality_Rate?",
  "sections": {
    "Task": "Dalculate the Pearson correlation coefficient between Vaccination_Rate and Mortality_Rate in the dataset provided in xlsx file named 'q-correlate-pair.xlsx'.\r\nWhat is the Pearson correlation coefficient between Vaccination_Rate and Mortality_Rate?"
  }
}
{
  "timestamp": "2025-08-10T16:29:01.482876",
  "prompt": "### System Instruction\nYou are a Python coding assistant. Your task is to generate executable Python code only.\n    Do not include markdown, explanations, comments, or formatting.\n\n    Your code must:\n    - Encapsulate logic in a function (e.g., scrape_and_analyze())\n    - Always include a top-level execution block using:\n        if __name__ == \"__main__\":\n            result = <function_name>()\n            print(result)\n\n    Important:\n    - Do NOT suppress errors using try-except blocks.\n    - If an error occurs (e.g., missing table, invalid data), raise a Python exception with a clear message.\n    - Do NOT return fallback values like \"N/A\" or \"Error: Table not found\".\n    - Let errors propagate so they can be detected and corrected in future iterations.\n\n    If plotting is involved:\n    - Invert ranks on the x-axis for better readability.\n    - Return the plot as a base64-encoded data URI.\n\n    Only return valid Python code that can be run directly in a script.\n\n### Task\nDalculate the Pearson correlation coefficient between Vaccination_Rate and Mortality_Rate in the dataset provided in xlsx file named 'q-correlate-pair.xlsx'.\r\nWhat is the Pearson correlation coefficient between Vaccination_Rate and Mortality_Rate?",
  "sections": {
    "Task": "Dalculate the Pearson correlation coefficient between Vaccination_Rate and Mortality_Rate in the dataset provided in xlsx file named 'q-correlate-pair.xlsx'.\r\nWhat is the Pearson correlation coefficient between Vaccination_Rate and Mortality_Rate?"
  }
}
{
  "timestamp": "2025-08-10T16:54:17.409103",
  "prompt": "### System Instruction\nYou are a Python coding assistant. Your task is to generate executable Python code only.\n    Do not include markdown, explanations, comments, or formatting.\n\n    Your code must:\n    - Encapsulate logic in a function (e.g., scrape_and_analyze())\n    - Always include a top-level execution block using:\n        if __name__ == \"__main__\":\n            result = <function_name>()\n            print(result)\n\n    Important:\n    - Do NOT suppress errors using try-except blocks.\n    - If an error occurs (e.g., missing table, invalid data), raise a Python exception with a clear message.\n    - Do NOT return fallback values like \"N/A\" or \"Error: Table not found\".\n    - Let errors propagate so they can be detected and corrected in future iterations.\n\n    If plotting is involved:\n    - Invert ranks on the x-axis for better readability.\n    - Return the plot as a base64-encoded data URI.\n\n    Only return valid Python code that can be run directly in a script.\n\n### Task\nUse Python to analyze the service request data and identify the peak hour (hour of day with the highest number of requests). The data contains mixed datetime formats that need to be standardized before analysis.\r\n\r\nPython Analysis Steps:\r\n\r\nRead the CSV file containing service request data in file named 'q-python-datetime-analysis.csv'\r\nImport pandas and parse the mixed datetime formats in the Timestamp column\r\nExtract the hour component from each timestamp\r\nCount requests by hour of day (0-23)\r\nIdentify the hour with the highest request volume\r\n\r\nWhat hour of the day (0-23) has the highest number of service requests?",
  "sections": {
    "Task": "Use Python to analyze the service request data and identify the peak hour (hour of day with the highest number of requests). The data contains mixed datetime formats that need to be standardized before analysis.\r\n\r\nPython Analysis Steps:\r\n\r\nRead the CSV file containing service request data in file named 'q-python-datetime-analysis.csv'\r\nImport pandas and parse the mixed datetime formats in the Timestamp column\r\nExtract the hour component from each timestamp\r\nCount requests by hour of day (0-23)\r\nIdentify the hour with the highest request volume\r\n\r\nWhat hour of the day (0-23) has the highest number of service requests?"
  }
}
{
  "timestamp": "2025-08-10T17:02:41.639012",
  "prompt": "### System Instruction\nYou are a Python coding assistant. Your task is to generate executable Python code only.\n    Do not include markdown, explanations, comments, or formatting.\n\n    Your code must:\n    - Encapsulate logic in a function (e.g., scrape_and_analyze())\n    - Always include a top-level execution block using:\n        if __name__ == \"__main__\":\n            result = <function_name>()\n            print(result)\n\n    Important:\n    - Do NOT suppress errors using try-except blocks.\n    - If an error occurs (e.g., missing table, invalid data), raise a Python exception with a clear message.\n    - Do NOT return fallback values like \"N/A\" or \"Error: Table not found\".\n    - Let errors propagate so they can be detected and corrected in future iterations.\n\n    If plotting is involved:\n    - Invert ranks on the x-axis for better readability.\n    - Return the plot as a base64-encoded data URI.\n\n    Only return valid Python code that can be run directly in a script.\n\n### Task\nThe Indian high court judgement dataset contains judgements from the Indian High Courts, downloaded from [ecourts website](https://judgments.ecourts.gov.in/). It contains judgments of 25 high courts, along with raw metadata (as .json) and structured metadata (as .parquet).\r\n\r\n- 25 high courts\r\n- ~16M judgments\r\n- ~1TB of data\r\n\r\nStructure of the data in the bucket:\r\n\r\n- `data/pdf/year=2025/court=xyz/bench=xyz/judgment1.pdf,judgment2.pdf`\r\n- `metadata/json/year=2025/court=xyz/bench=xyz/judgment1.json,judgment2.json`\r\n- `metadata/parquet/year=2025/court=xyz/bench=xyz/metadata.parquet`\r\n- `metadata/tar/year=2025/court=xyz/bench=xyz/metadata.tar.gz`\r\n- `data/tar/year=2025/court=xyz/bench=xyz/pdfs.tar`\r\n\r\nThis DuckDB query counts the number of decisions in the dataset.\r\n\r\n```sql\r\nINSTALL httpfs; LOAD httpfs;\r\nINSTALL parquet; LOAD parquet;\r\n\r\nSELECT COUNT(*) FROM read_parquet('s3://indian-high-court-judgments/metadata/parquet/year=*/court=*/bench=*/metadata.parquet?s3_region=ap-south-1');\r\n```\r\n\r\nHere are the columns in the data:\r\n\r\n| Column                 | Type    | Description                    |\r\n| ---------------------- | ------- | ------------------------------ |\r\n| `court_code`           | VARCHAR | Court identifier (e.g., 33~10) |\r\n| `title`                | VARCHAR | Case title and parties         |\r\n| `description`          | VARCHAR | Case description               |\r\n| `judge`                | VARCHAR | Presiding judge(s)             |\r\n| `pdf_link`             | VARCHAR | Link to judgment PDF           |\r\n| `cnr`                  | VARCHAR | Case Number Register           |\r\n| `date_of_registration` | VARCHAR | Registration date              |\r\n| `decision_date`        | DATE    | Date of judgment               |\r\n| `disposal_nature`      | VARCHAR | Case outcome                   |\r\n| `court`                | VARCHAR | Court name                     |\r\n| `raw_html`             | VARCHAR | Original HTML content          |\r\n| `bench`                | VARCHAR | Bench identifier               |\r\n| `year`                 | BIGINT  | Year partition                 |\r\n\r\nHere is a sample row:\r\n\r\n```json\r\n{\r\n  \"court_code\": \"33~10\",\r\n  \"title\": \"CRL MP(MD)/4399/2023 of Vinoth Vs The Inspector of Police\",\r\n  \"description\": \"No.4399 of 2023 BEFORE THE MADURAI BENCH OF MADRAS HIGH COURT ( Criminal Jurisdiction ) Thursday, ...\",\r\n  \"judge\": \"HONOURABLE  MR JUSTICE G.K. ILANTHIRAIYAN\",\r\n  \"pdf_link\": \"court/cnrorders/mdubench/orders/HCMD010287762023_1_2023-03-16.pdf\",\r\n  \"cnr\": \"HCMD010287762023\",\r\n  \"date_of_registration\": \"14-03-2023\",\r\n  \"decision_date\": \"2023-03-16\",\r\n  \"disposal_nature\": \"DISMISSED\",\r\n  \"court\": \"33_10\",\r\n  \"raw_html\": \"<button type='button' role='link'..\",\r\n  \"bench\": \"mdubench\",\r\n  \"year\": 2023\r\n}\r\n```\r\n\r\nAnswer the following questions and respond with a JSON object containing the answer.\r\n\r\n```json\r\n{\r\n  \"Which high court disposed the most cases from 2019 - 2022?\": \"...\",\r\n  \"What's the regression slope of the date_of_registration - decision_date by year in the court=33_10?\": \"...\",\r\n  \"Plot the year and # of days of delay from the above question as a scatterplot with a regression line. Encode as a base64 data URI under 100,000 characters\": \"data:image/webp:base64,...\"\r\n}\r\n```",
  "sections": {
    "Task": "The Indian high court judgement dataset contains judgements from the Indian High Courts, downloaded from [ecourts website](https://judgments.ecourts.gov.in/). It contains judgments of 25 high courts, along with raw metadata (as .json) and structured metadata (as .parquet).\r\n\r\n- 25 high courts\r\n- ~16M judgments\r\n- ~1TB of data\r\n\r\nStructure of the data in the bucket:\r\n\r\n- `data/pdf/year=2025/court=xyz/bench=xyz/judgment1.pdf,judgment2.pdf`\r\n- `metadata/json/year=2025/court=xyz/bench=xyz/judgment1.json,judgment2.json`\r\n- `metadata/parquet/year=2025/court=xyz/bench=xyz/metadata.parquet`\r\n- `metadata/tar/year=2025/court=xyz/bench=xyz/metadata.tar.gz`\r\n- `data/tar/year=2025/court=xyz/bench=xyz/pdfs.tar`\r\n\r\nThis DuckDB query counts the number of decisions in the dataset.\r\n\r\n```sql\r\nINSTALL httpfs; LOAD httpfs;\r\nINSTALL parquet; LOAD parquet;\r\n\r\nSELECT COUNT(*) FROM read_parquet('s3://indian-high-court-judgments/metadata/parquet/year=*/court=*/bench=*/metadata.parquet?s3_region=ap-south-1');\r\n```\r\n\r\nHere are the columns in the data:\r\n\r\n| Column                 | Type    | Description                    |\r\n| ---------------------- | ------- | ------------------------------ |\r\n| `court_code`           | VARCHAR | Court identifier (e.g., 33~10) |\r\n| `title`                | VARCHAR | Case title and parties         |\r\n| `description`          | VARCHAR | Case description               |\r\n| `judge`                | VARCHAR | Presiding judge(s)             |\r\n| `pdf_link`             | VARCHAR | Link to judgment PDF           |\r\n| `cnr`                  | VARCHAR | Case Number Register           |\r\n| `date_of_registration` | VARCHAR | Registration date              |\r\n| `decision_date`        | DATE    | Date of judgment               |\r\n| `disposal_nature`      | VARCHAR | Case outcome                   |\r\n| `court`                | VARCHAR | Court name                     |\r\n| `raw_html`             | VARCHAR | Original HTML content          |\r\n| `bench`                | VARCHAR | Bench identifier               |\r\n| `year`                 | BIGINT  | Year partition                 |\r\n\r\nHere is a sample row:\r\n\r\n```json\r\n{\r\n  \"court_code\": \"33~10\",\r\n  \"title\": \"CRL MP(MD)/4399/2023 of Vinoth Vs The Inspector of Police\",\r\n  \"description\": \"No.4399 of 2023 BEFORE THE MADURAI BENCH OF MADRAS HIGH COURT ( Criminal Jurisdiction ) Thursday, ...\",\r\n  \"judge\": \"HONOURABLE  MR JUSTICE G.K. ILANTHIRAIYAN\",\r\n  \"pdf_link\": \"court/cnrorders/mdubench/orders/HCMD010287762023_1_2023-03-16.pdf\",\r\n  \"cnr\": \"HCMD010287762023\",\r\n  \"date_of_registration\": \"14-03-2023\",\r\n  \"decision_date\": \"2023-03-16\",\r\n  \"disposal_nature\": \"DISMISSED\",\r\n  \"court\": \"33_10\",\r\n  \"raw_html\": \"<button type='button' role='link'..\",\r\n  \"bench\": \"mdubench\",\r\n  \"year\": 2023\r\n}\r\n```\r\n\r\nAnswer the following questions and respond with a JSON object containing the answer.\r\n\r\n```json\r\n{\r\n  \"Which high court disposed the most cases from 2019 - 2022?\": \"...\",\r\n  \"What's the regression slope of the date_of_registration - decision_date by year in the court=33_10?\": \"...\",\r\n  \"Plot the year and # of days of delay from the above question as a scatterplot with a regression line. Encode as a base64 data URI under 100,000 characters\": \"data:image/webp:base64,...\"\r\n}\r\n```"
  }
}
{
  "timestamp": "2025-08-10T17:12:39.418171",
  "prompt": "### System Instruction\nYou are a Python coding assistant. Your task is to generate executable Python code only.\n    Do not include markdown, explanations, comments, or formatting.\n\n    Your code must:\n    - Encapsulate logic in a function (e.g., scrape_and_analyze())\n    - Always include a top-level execution block using:\n        if __name__ == \"__main__\":\n            result = <function_name>()\n            print(result)\n\n    Important:\n    - Do NOT suppress errors using try-except blocks.\n    - If an error occurs (e.g., missing table, invalid data), raise a Python exception with a clear message.\n    - Do NOT return fallback values like \"N/A\" or \"Error: Table not found\".\n    - Let errors propagate so they can be detected and corrected in future iterations.\n\n    If plotting is involved:\n    - Invert ranks on the x-axis for better readability.\n    - Return the plot as a base64-encoded data URI.\n\n    Only return valid Python code that can be run directly in a script.\n\n### Task\nAnalyze `sample-sales.csv`.\n\nReturn a JSON object with keys:\n- `total_sales`: number\n- `top_region`: string\n- `day_sales_correlation`: number\n- `bar_chart`: base64 PNG string under 100kB\n- `median_sales`: number\n- `total_sales_tax`: number\n- `cumulative_sales_chart`: base64 PNG string under 100kB\n\nAnswer:\n1. What is the total sales across all regions?\n2. Which region has the highest total sales?\n3. What is the correlation between day of month and sales? (Use the date column.)\n4. Plot total sales by region as a bar chart with blue bars. Encode as base64 PNG.\n5. What is the median sales amount across all orders?\n6. What is the total sales tax if the tax rate is 10%?\n7. Plot cumulative sales over time as a line chart with a red line. Encode as base64 PNG.",
  "sections": {
    "Task": "Analyze `sample-sales.csv`.\n\nReturn a JSON object with keys:\n- `total_sales`: number\n- `top_region`: string\n- `day_sales_correlation`: number\n- `bar_chart`: base64 PNG string under 100kB\n- `median_sales`: number\n- `total_sales_tax`: number\n- `cumulative_sales_chart`: base64 PNG string under 100kB\n\nAnswer:\n1. What is the total sales across all regions?\n2. Which region has the highest total sales?\n3. What is the correlation between day of month and sales? (Use the date column.)\n4. Plot total sales by region as a bar chart with blue bars. Encode as base64 PNG.\n5. What is the median sales amount across all orders?\n6. What is the total sales tax if the tax rate is 10%?\n7. Plot cumulative sales over time as a line chart with a red line. Encode as base64 PNG."
  }
}
{
  "timestamp": "2025-08-10T17:47:31.997890",
  "prompt": "### System Instruction\nYou are a Python coding assistant. Your task is to generate executable Python code only.\n    Do not include markdown, explanations, comments, or formatting.\n\n    Your code must:\n    - Encapsulate logic in a function (e.g., scrape_and_analyze())\n    - Always include a top-level execution block using:\n        if __name__ == \"__main__\":\n            result = <function_name>()\n            print(result)\n\n    Important:\n    - Do NOT suppress errors using try-except blocks.\n    - If an error occurs (e.g., missing table, invalid data), raise a Python exception with a clear message.\n    - Do NOT return fallback values like \"N/A\" or \"Error: Table not found\".\n    - Let errors propagate so they can be detected and corrected in future iterations.\n\n    If plotting is involved:\n    - Invert ranks on the x-axis for better readability.\n    - Return the plot as a base64-encoded data URI.\n\n    Only return valid Python code that can be run directly in a script.\n\n### Task\nAnalyze `sample-sales.csv`.\n\nReturn a JSON object with keys:\n- `total_sales`: number\n- `top_region`: string\n- `day_sales_correlation`: number\n- `bar_chart`: base64 PNG string under 100kB\n- `median_sales`: number\n- `total_sales_tax`: number\n- `cumulative_sales_chart`: base64 PNG string under 100kB\n\nAnswer:\n1. What is the total sales across all regions?\n2. Which region has the highest total sales?\n3. What is the correlation between day of month and sales? (Use the date column.)\n4. Plot total sales by region as a bar chart with blue bars. Encode as base64 PNG.\n5. What is the median sales amount across all orders?\n6. What is the total sales tax if the tax rate is 10%?\n7. Plot cumulative sales over time as a line chart with a red line. Encode as base64 PNG.\n\n\nThe CSV file contains the following columns:\n- `order_id`: column from CSV\n- `date`: column from CSV\n- `region`: column from CSV\n- `sales`: column from CSV",
  "sections": {
    "Task": "Analyze `sample-sales.csv`.\n\nReturn a JSON object with keys:\n- `total_sales`: number\n- `top_region`: string\n- `day_sales_correlation`: number\n- `bar_chart`: base64 PNG string under 100kB\n- `median_sales`: number\n- `total_sales_tax`: number\n- `cumulative_sales_chart`: base64 PNG string under 100kB\n\nAnswer:\n1. What is the total sales across all regions?\n2. Which region has the highest total sales?\n3. What is the correlation between day of month and sales? (Use the date column.)\n4. Plot total sales by region as a bar chart with blue bars. Encode as base64 PNG.\n5. What is the median sales amount across all orders?\n6. What is the total sales tax if the tax rate is 10%?\n7. Plot cumulative sales over time as a line chart with a red line. Encode as base64 PNG.\n\n\nThe CSV file contains the following columns:\n- `order_id`: column from CSV\n- `date`: column from CSV\n- `region`: column from CSV\n- `sales`: column from CSV"
  }
}
{
  "timestamp": "2025-08-10T17:49:45.691768",
  "prompt": "### System Instruction\nYou are a Python coding assistant. Your task is to generate executable Python code only.\n    Do not include markdown, explanations, comments, or formatting.\n\n    Your code must:\n    - Encapsulate logic in a function (e.g., scrape_and_analyze())\n    - Always include a top-level execution block using:\n        if __name__ == \"__main__\":\n            result = <function_name>()\n            print(result)\n\n    Important:\n    - Do NOT suppress errors using try-except blocks.\n    - If an error occurs (e.g., missing table, invalid data), raise a Python exception with a clear message.\n    - Do NOT return fallback values like \"N/A\" or \"Error: Table not found\".\n    - Let errors propagate so they can be detected and corrected in future iterations.\n\n    If plotting is involved:\n    - Invert ranks on the x-axis for better readability.\n    - Return the plot as a base64-encoded data URI.\n\n    Only return valid Python code that can be run directly in a script.\n\n### Task\nThe Indian high court judgement dataset contains judgements from the Indian High Courts, downloaded from [ecourts website](https://judgments.ecourts.gov.in/). It contains judgments of 25 high courts, along with raw metadata (as .json) and structured metadata (as .parquet).\r\n\r\n- 25 high courts\r\n- ~16M judgments\r\n- ~1TB of data\r\n\r\nStructure of the data in the bucket:\r\n\r\n- `data/pdf/year=2025/court=xyz/bench=xyz/judgment1.pdf,judgment2.pdf`\r\n- `metadata/json/year=2025/court=xyz/bench=xyz/judgment1.json,judgment2.json`\r\n- `metadata/parquet/year=2025/court=xyz/bench=xyz/metadata.parquet`\r\n- `metadata/tar/year=2025/court=xyz/bench=xyz/metadata.tar.gz`\r\n- `data/tar/year=2025/court=xyz/bench=xyz/pdfs.tar`\r\n\r\nThis DuckDB query counts the number of decisions in the dataset.\r\n\r\n```sql\r\nINSTALL httpfs; LOAD httpfs;\r\nINSTALL parquet; LOAD parquet;\r\n\r\nSELECT COUNT(*) FROM read_parquet('s3://indian-high-court-judgments/metadata/parquet/year=*/court=*/bench=*/metadata.parquet?s3_region=ap-south-1');\r\n```\r\n\r\nHere are the columns in the data:\r\n\r\n| Column                 | Type    | Description                    |\r\n| ---------------------- | ------- | ------------------------------ |\r\n| `court_code`           | VARCHAR | Court identifier (e.g., 33~10) |\r\n| `title`                | VARCHAR | Case title and parties         |\r\n| `description`          | VARCHAR | Case description               |\r\n| `judge`                | VARCHAR | Presiding judge(s)             |\r\n| `pdf_link`             | VARCHAR | Link to judgment PDF           |\r\n| `cnr`                  | VARCHAR | Case Number Register           |\r\n| `date_of_registration` | VARCHAR | Registration date              |\r\n| `decision_date`        | DATE    | Date of judgment               |\r\n| `disposal_nature`      | VARCHAR | Case outcome                   |\r\n| `court`                | VARCHAR | Court name                     |\r\n| `raw_html`             | VARCHAR | Original HTML content          |\r\n| `bench`                | VARCHAR | Bench identifier               |\r\n| `year`                 | BIGINT  | Year partition                 |\r\n\r\nHere is a sample row:\r\n\r\n```json\r\n{\r\n  \"court_code\": \"33~10\",\r\n  \"title\": \"CRL MP(MD)/4399/2023 of Vinoth Vs The Inspector of Police\",\r\n  \"description\": \"No.4399 of 2023 BEFORE THE MADURAI BENCH OF MADRAS HIGH COURT ( Criminal Jurisdiction ) Thursday, ...\",\r\n  \"judge\": \"HONOURABLE  MR JUSTICE G.K. ILANTHIRAIYAN\",\r\n  \"pdf_link\": \"court/cnrorders/mdubench/orders/HCMD010287762023_1_2023-03-16.pdf\",\r\n  \"cnr\": \"HCMD010287762023\",\r\n  \"date_of_registration\": \"14-03-2023\",\r\n  \"decision_date\": \"2023-03-16\",\r\n  \"disposal_nature\": \"DISMISSED\",\r\n  \"court\": \"33_10\",\r\n  \"raw_html\": \"<button type='button' role='link'..\",\r\n  \"bench\": \"mdubench\",\r\n  \"year\": 2023\r\n}\r\n```\r\n\r\nAnswer the following questions and respond with a JSON object containing the answer.\r\n\r\n```json\r\n{\r\n  \"Which high court disposed the most cases from 2019 - 2022?\": \"...\",\r\n  \"What's the regression slope of the date_of_registration - decision_date by year in the court=33_10?\": \"...\",\r\n  \"Plot the year and # of days of delay from the above question as a scatterplot with a regression line. Encode as a base64 data URI under 100,000 characters\": \"data:image/webp:base64,...\"\r\n}\r\n```",
  "sections": {
    "Task": "The Indian high court judgement dataset contains judgements from the Indian High Courts, downloaded from [ecourts website](https://judgments.ecourts.gov.in/). It contains judgments of 25 high courts, along with raw metadata (as .json) and structured metadata (as .parquet).\r\n\r\n- 25 high courts\r\n- ~16M judgments\r\n- ~1TB of data\r\n\r\nStructure of the data in the bucket:\r\n\r\n- `data/pdf/year=2025/court=xyz/bench=xyz/judgment1.pdf,judgment2.pdf`\r\n- `metadata/json/year=2025/court=xyz/bench=xyz/judgment1.json,judgment2.json`\r\n- `metadata/parquet/year=2025/court=xyz/bench=xyz/metadata.parquet`\r\n- `metadata/tar/year=2025/court=xyz/bench=xyz/metadata.tar.gz`\r\n- `data/tar/year=2025/court=xyz/bench=xyz/pdfs.tar`\r\n\r\nThis DuckDB query counts the number of decisions in the dataset.\r\n\r\n```sql\r\nINSTALL httpfs; LOAD httpfs;\r\nINSTALL parquet; LOAD parquet;\r\n\r\nSELECT COUNT(*) FROM read_parquet('s3://indian-high-court-judgments/metadata/parquet/year=*/court=*/bench=*/metadata.parquet?s3_region=ap-south-1');\r\n```\r\n\r\nHere are the columns in the data:\r\n\r\n| Column                 | Type    | Description                    |\r\n| ---------------------- | ------- | ------------------------------ |\r\n| `court_code`           | VARCHAR | Court identifier (e.g., 33~10) |\r\n| `title`                | VARCHAR | Case title and parties         |\r\n| `description`          | VARCHAR | Case description               |\r\n| `judge`                | VARCHAR | Presiding judge(s)             |\r\n| `pdf_link`             | VARCHAR | Link to judgment PDF           |\r\n| `cnr`                  | VARCHAR | Case Number Register           |\r\n| `date_of_registration` | VARCHAR | Registration date              |\r\n| `decision_date`        | DATE    | Date of judgment               |\r\n| `disposal_nature`      | VARCHAR | Case outcome                   |\r\n| `court`                | VARCHAR | Court name                     |\r\n| `raw_html`             | VARCHAR | Original HTML content          |\r\n| `bench`                | VARCHAR | Bench identifier               |\r\n| `year`                 | BIGINT  | Year partition                 |\r\n\r\nHere is a sample row:\r\n\r\n```json\r\n{\r\n  \"court_code\": \"33~10\",\r\n  \"title\": \"CRL MP(MD)/4399/2023 of Vinoth Vs The Inspector of Police\",\r\n  \"description\": \"No.4399 of 2023 BEFORE THE MADURAI BENCH OF MADRAS HIGH COURT ( Criminal Jurisdiction ) Thursday, ...\",\r\n  \"judge\": \"HONOURABLE  MR JUSTICE G.K. ILANTHIRAIYAN\",\r\n  \"pdf_link\": \"court/cnrorders/mdubench/orders/HCMD010287762023_1_2023-03-16.pdf\",\r\n  \"cnr\": \"HCMD010287762023\",\r\n  \"date_of_registration\": \"14-03-2023\",\r\n  \"decision_date\": \"2023-03-16\",\r\n  \"disposal_nature\": \"DISMISSED\",\r\n  \"court\": \"33_10\",\r\n  \"raw_html\": \"<button type='button' role='link'..\",\r\n  \"bench\": \"mdubench\",\r\n  \"year\": 2023\r\n}\r\n```\r\n\r\nAnswer the following questions and respond with a JSON object containing the answer.\r\n\r\n```json\r\n{\r\n  \"Which high court disposed the most cases from 2019 - 2022?\": \"...\",\r\n  \"What's the regression slope of the date_of_registration - decision_date by year in the court=33_10?\": \"...\",\r\n  \"Plot the year and # of days of delay from the above question as a scatterplot with a regression line. Encode as a base64 data URI under 100,000 characters\": \"data:image/webp:base64,...\"\r\n}\r\n```"
  }
}
